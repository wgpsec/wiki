---
title: ã€CRYPTOã€‘CBC
---

# CBC

## ç°ä»£å¯†ç ä½“åˆ¶

> ç°ä»£å¯†ç ä¸­çš„åŠ å¯†ä½“åˆ¶ä¸€èˆ¬åˆ†ä¸ºå¯¹ç§°åŠ å¯†ä½“åˆ¶(Symmetric Key Encryption)å’Œéå¯¹ç§°åŠ å¯†ä½“åˆ¶(Asymmetric Key Encryption)ã€‚å¯¹ç§°åŠ å¯†åˆè¢«åˆ†ä¸ºåˆ†ç»„åŠ å¯†å’Œåºåˆ—å¯†ç ã€‚ 
>
> åˆ†ç»„å¯†ç ï¼šä¹Ÿå«å—åŠ å¯†(block cyphers)ï¼Œä¸€æ¬¡åŠ å¯†æ˜æ–‡ä¸­çš„ä¸€ä¸ªå—ã€‚åˆ†ç»„å¯†ç æ˜¯å°†æ˜æ–‡æŒ‰ä¸€å®šçš„ä½é•¿åˆ†ç»„ï¼Œæ˜æ–‡ç»„ç»è¿‡åŠ å¯†è¿ç®—å¾—åˆ°å¯†æ–‡ç»„ï¼Œå¯†æ–‡ç»„ç»è¿‡è§£å¯†è¿ç®—ï¼ˆåŠ å¯†è¿ç®—çš„é€†è¿ç®—ï¼‰ï¼Œè¿˜åŸæˆæ˜æ–‡ç»„ï¼Œä¸»è¦æœ‰ ECBï¼ˆç”µå­å¯†ç æœ¬æ¨¡å¼ï¼‰ ï¼ŒCBC ï¼ˆå¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼ï¼‰ ï¼ŒCFB ï¼ˆå¯†æ–‡åé¦ˆæ¨¡å¼ï¼‰ ï¼ŒOFB ï¼ˆè¾“å‡ºåé¦ˆæ¨¡å¼ï¼‰ï¼Œ  CTRæ¨¡å¼ï¼ˆè®¡æ•°å™¨æ¨¡å¼ï¼‰ äº”ç§å·¥ä½œæ¨¡å¼ã€‚
>
> åºåˆ—å¯†ç ï¼šä¹Ÿå«æµåŠ å¯†(stream cyphers)ï¼Œä¸€æ¬¡åŠ å¯†æ˜æ–‡ä¸­çš„ä¸€ä¸ªä½ã€‚åºåˆ—å¯†ç æ˜¯æŒ‡åˆ©ç”¨å°‘é‡çš„å¯†é’¥ï¼ˆåˆ¶ä¹±å…ƒç´ ï¼‰é€šè¿‡æŸç§å¤æ‚çš„è¿ç®—ï¼ˆå¯†ç ç®—æ³•ï¼‰äº§ç”Ÿå¤§é‡çš„ä¼ªéšæœºä½æµï¼Œç”¨äºå¯¹æ˜æ–‡ä½æµçš„åŠ å¯†ã€‚è§£å¯†æ˜¯æŒ‡ç”¨åŒæ ·çš„å¯†é’¥å’Œå¯†ç ç®—æ³•åŠä¸åŠ å¯†ç›¸åŒçš„ä¼ªéšæœºä½æµï¼Œç”¨ä»¥è¿˜åŸæ˜æ–‡ä½æµã€‚  

## CBC æ¨¡å¼

> CBC (Cipher Block Chaining, å¯†ç åˆ†ç»„é“¾æ¥) æ¨¡å¼ä¸­æ¯ä¸€ä¸ªåˆ†ç»„è¦å…ˆå’Œå‰ä¸€ä¸ªåˆ†ç»„åŠ å¯†åçš„æ•°æ®è¿›è¡ŒXORå¼‚æˆ–æ“ä½œï¼Œç„¶åå†è¿›è¡ŒåŠ å¯†ã€‚è¿™æ ·æ¯ä¸ªå¯†æ–‡å—ä¾èµ–è¯¥å—ä¹‹å‰çš„æ‰€æœ‰æ˜æ–‡å—ï¼Œä¸ºäº†ä¿æŒæ¯æ¡æ¶ˆæ¯éƒ½å…·æœ‰å”¯ä¸€æ€§ï¼Œç¬¬ä¸€ä¸ªæ•°æ®å—è¿›è¡ŒåŠ å¯†ä¹‹å‰éœ€è¦ç”¨åˆå§‹åŒ–å‘é‡IVè¿›è¡Œå¼‚æˆ–æ“ä½œã€‚CBCæ¨¡å¼æ˜¯ä¸€ç§æœ€å¸¸ç”¨çš„åŠ å¯†æ¨¡å¼ï¼Œå®ƒä¸»è¦ç¼ºç‚¹æ˜¯éœ€è¦åˆå§‹å‘é‡ï¼ŒåŠ å¯†æ˜¯è¿ç»­çš„ï¼Œä¸èƒ½å¹¶è¡Œå¤„ç†ï¼Œå¹¶ä¸”ä¸ECBä¸€æ ·æ¶ˆæ¯å—å¿…é¡»å¡«å……åˆ°å—å¤§å°çš„æ•´å€æ•°ã€‚ 

## CBC å·¥ä½œæ¨¡å¼

### åŠ å¯†è¿‡ç¨‹

![CBC](/images/CBC/CBCE.png)

ä¸Šå›¾ä¸ºCBCåŠ å¯†åŸç†å›¾

> - Plaintextï¼šæ˜æ–‡ï¼Œå¾…åŠ å¯†çš„æ•°æ®
> - IV ï¼šåˆå§‹å‘é‡ï¼Œç”¨äºéšæœºåŒ–åŠ å¯†çš„æ¯”ç‰¹å—ï¼Œä¿è¯å³ä½¿å¯¹ç›¸åŒæ˜æ–‡å¤šæ¬¡åŠ å¯†ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°ä¸åŒçš„å¯†æ–‡
> - Keyï¼šåˆ†ç»„åŠ å¯†ä½¿ç”¨çš„å¯¹ç§°å¯†é’¥ï¼Œç”±AESï¼ŒBlowfishï¼ŒDESï¼ŒTriple DESç­‰å¯¹ç§°åŠ å¯†ç®—æ³•ä½¿ç”¨
> - Ciphertextï¼šåŠ å¯†åçš„æ•°æ®ï¼Œä¹Ÿå«å¯†æ–‡æ•°æ®
> - å›ºå®šåˆ†ç»„ï¼šCBCåœ¨ä¸€ä¸ªå›ºå®šé•¿åº¦çš„ä½ç»„ä¸Šå·¥ä½œï¼Œç§°ä¸ºå—ã€‚è¿™é‡Œä½¿ç”¨åŒ…å«16å­—èŠ‚çš„å—è¿›è¡Œè¯´æ˜

#### æ–‡å­—æµç¨‹

ä¸»è¦æµç¨‹ï¼šå‰ä¸€ç»„å¯†æ–‡å—ç”¨æ¥äº§ç”Ÿåä¸€ç»„å¯†æ–‡å—

> 1. é¦–å…ˆå°†æ˜æ–‡åˆ†ç»„(å¸¸è§çš„ä»¥16å­—èŠ‚ä¸ºä¸€ç»„)ï¼Œä½æ•°ä¸è¶³çš„ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦å¡«å……
> 2. ç”Ÿæˆä¸€ä¸ªéšæœºçš„åˆå§‹åŒ–å‘é‡(IV)å’Œä¸€ä¸ªå¯†é’¥
> 3. å°†IVå’Œç¬¬ä¸€ç»„æ˜æ–‡å¼‚æˆ–äº§ç”Ÿåˆæ­¥å¯†æ–‡ï¼Œå†ç”¨å¯†é’¥å¯¹åˆæ­¥å¯†æ–‡åŠ å¯†ç”Ÿæˆæœ€ç»ˆå¯†æ–‡å—
> 4. ç”¨å¯†é’¥å¯¹3ä¸­xoråäº§ç”Ÿçš„å¯†æ–‡è¿›è¡ŒåŠ å¯†
> 5. ç”¨4ä¸­äº§ç”Ÿçš„å¯†æ–‡å¯¹ç¬¬äºŒç»„æ˜æ–‡è¿›è¡Œxoræ“ä½œ
> 6. ç”¨å¯†é’¥å¯¹5ä¸­äº§ç”Ÿçš„å¯†æ–‡è¿›è¡ŒåŠ å¯†
> 7. é‡å¤4-7ï¼Œç›´è‡³æœ€åä¸€ç»„æ˜æ–‡
> 8. å°†IVå’ŒåŠ å¯†åçš„å¯†æ–‡å—æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå¾—åˆ°æœ€ç»ˆçš„å¯†æ–‡

ä»ç¬¬ä¸€å— Plaintext å¼€å§‹ï¼Œé¦–å…ˆä¸ä¸€ä¸ªåˆå§‹å‘é‡IVå¼‚æˆ–ï¼ˆIVåªåœ¨ç¬¬ä¸€å—å‘æŒ¥ä½œç”¨ï¼‰ï¼Œç„¶åæŠŠå¼‚æˆ–çš„ç»“æœç»è¿‡keyè¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°ç¬¬ä¸€å—çš„å¯†æ–‡ï¼Œå¹¶ä¸”æŠŠåŠ å¯†çš„ç»“æœä¸ä¸‹ä¸€å—çš„æ˜æ–‡è¿›è¡Œå¼‚æˆ–ï¼Œä¸€ç›´è¿™æ ·é‡å¤è¿›è¡Œä¸‹å»ç›´è‡³æœ€åä¸€ç»„æ˜æ–‡ã€‚

#### å…¬å¼æè¿°

> - Ciphertext-0 = Encrypt(Plaintext XOR IV)		#  åªç”¨äºç¬¬ä¸€ä¸ªç»„å—  
> - Ciphertext-N = Encrypt(Plaintext XOR Ciphertext-(N-1)		#  ç”¨äºç¬¬äºŒåŠå‰©ä¸‹çš„ç»„å—(N > 1)

#### ä»£ç è§£æ

```C
cypher_t* aes_cbc_encrypt(uint8_t* key, cypher_t* data_in)
{
    //pad last block with 0
    cypher_t* data_in_padding = block_padding(data_in);
    cypher_t* cypher_out = (cypher_t*)malloc(sizeof(uint8_t) + data_in->len_data);
    cypher_out->len_data = data_in_padding->len_data;

    uint8_t iv[16] = {0};
    memcpy(iv, IV, 16);
    uint8_t temp_out[16] = {0};
    for (uint8_t index = 0; index < data_in_padding->len_data/16 ; ++index){
        array_xor(16, temp_out, data_in_padding->data + (index * 16), iv);      //æ˜æ–‡ä¸ivå¼‚æˆ–
        _aes128_encryption(key, cypher_out->data + index * 16, temp_out);       //è¿›è¡Œå—åŠ å¯†å¾—åˆ°å¯†æ–‡ï¼ŒåŒæ—¶å¯†æ–‡æ˜¯ä¸‹æ¬¡åŠ å¯†çš„iv
        memcpy(iv, cypher_out->data + index * 16, 16);                          //æœ¬æ¬¡çš„å¯†æ–‡æ˜¯ä¸‹æ¬¡åŠ å¯†çš„iv
    }
    free(data_in_padding);
    return cypher_out;
}
```

### è§£å¯†è¿‡ç¨‹

![CBCD](/images/CBC/CBCD.png)

ä¸Šå›¾ä¸ºCBCè§£å¯†åŸç†å›¾

åªè¦äº†è§£äº†è§£å¯†åŠ å¯†è¿‡ç¨‹ï¼Œåè¿‡æ¥çœ‹è§£å¯†è¿‡ç¨‹ä¹Ÿå°±æ¯”è¾ƒç®€å•äº†

#### æ–‡å­—æµç¨‹

ä¸»è¦æµç¨‹ï¼šå‰ä¸€ç»„å¯†æ–‡å—å½±å“åä¸€ç»„å¯†æ–‡å—çš„è¿˜åŸ

> 1. ä»å¯†æ–‡ä¸­æå–å‡ºIVï¼Œç„¶åå°†å¯†æ–‡åˆ†ç»„
> 2. ä½¿ç”¨å¯†é’¥å¯¹ç¬¬ä¸€ç»„å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œç„¶åå’ŒIVè¿›è¡Œxorå¾—åˆ°æ˜æ–‡
> 3. ä½¿ç”¨å¯†é’¥å¯¹ç¬¬äºŒç»„å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œç„¶åå’Œ2ä¸­çš„å¯†æ–‡xorå¾—åˆ°æ˜æ–‡
> 4. é‡å¤2-3ï¼Œç›´è‡³æœ€åä¸€ç»„å¯†æ–‡

#### å…¬å¼æè¿°

> - Plaintext-0 = Decrypt(Ciphertext) XOR IV		#  åªç”¨äºç¬¬ä¸€ä¸ªç»„å—  
> - Plaintext-N = Decrypt(Ciphertext) XOR Ciphertext-(N-1)		#  ç”¨äºç¬¬äºŒåŠå‰©ä¸‹çš„ç»„å—(N > 1)

#### ä»£ç è§£æ

```c
cypher_t* aes_cbc_decrypt(uint8_t* key, cypher_t* data_in)
{
    cypher_t* cypher_padding = block_padding(data_in);
    cypher_t* plain = (cypher_t*)malloc(data_in->len_data);
    plain->len_data = cypher_padding->len_data;
    uint8_t iv[16] = {0};
    memcpy(iv, IV, 16);
    uint8_t temp_out[16] = {0};
    for (uint8_t index = 0; index < cypher_padding->len_data/16 ; ++index){
        _aes128_decryption(key, temp_out, cypher_padding->data + (index*16));   //å¯†æ–‡å—è§£å¯†
        array_xor(16, plain->data + (index*16), temp_out, iv);                  //ä¸ivå¼‚æˆ–å¾—åˆ°æ˜æ–‡
        memcpy(iv, cypher_padding->data + (index*16), 16);                      //è®¾ç½®ä¸‹æ¬¡è§£å¯†ç”¨åˆ°çš„iv
    }
    free(cypher_padding);
    return plain;
}
```

## Padding oracle

### æ”»å‡»æµç¨‹

æ˜æ–‡å¡«å……

> - åˆ†ç»„å¯†ç  Block Cipher éœ€è¦åœ¨åŠ è½½å‰ç¡®ä¿æ¯ä¸ªæ¯ç»„çš„é•¿åº¦éƒ½æ˜¯åˆ†ç»„é•¿åº¦çš„æ•´æ•°å€ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ˜æ–‡çš„æœ€åä¸€ä¸ªåˆ†ç»„å¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°é•¿åº¦ä¸è¶³åˆ†ç»„çš„é•¿åº¦ã€‚
>
> - è¿™ä¸ªæ—¶å€™ï¼Œæ™®éçš„åšæ³•æ˜¯åœ¨æœ€åä¸€ç»„å¯†æ–‡å—åå¡«å……ä¸€ä¸ªå›ºå®šçš„å€¼ï¼Œè¿™ä¸ªå€¼çš„å¤§å°ä¸ºå¡«å……çš„å­—èŠ‚æ€»æ•°ã€‚
>
> ```
> æœ€åè¿˜å·®1ä¸ªå­—ç¬¦ï¼Œåˆ™å¡«å……1ä¸ª0x01ï¼›
> æœ€åè¿˜å·®2ä¸ªå­—ç¬¦ï¼Œåˆ™å¡«å……2ä¸ª0x02ï¼›
> æœ€åè¿˜å·®3ä¸ªå­—ç¬¦ï¼Œåˆ™å¡«å……3ä¸ª0x03ï¼›
> æœ€åè¿˜å·®4ä¸ªå­—ç¬¦ï¼Œåˆ™å¡«å……4ä¸ª0x04ï¼›
> è¿™é‡Œç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå¦‚æœæ˜æ–‡é•¿åº¦ä¸º16çš„æ•´æ•°å­—èŠ‚é•¿ï¼Œå®ƒä¹Ÿéœ€è¦å¡«å……ï¼ˆå®ƒä¼šä¸€æ¬¡å¡«å……16ä½ï¼Œä¸”å¡«å……çš„å­—ç¬¦ä¸º0x10ï¼‰
> ```
>
> - å¡«å……ä¸»è¦å‘ç”Ÿåœ¨æœ€åä¸€ç»„å¯†æ–‡å—ï¼Œæˆ‘ä»¬éœ€è¦æ ¼å¤–å…³æ³¨æœ€åä¸€ä¸ªåˆ†ç»„ã€‚
> - ä¾‹å¦‚æœ€åä¸€ç»„çš„æœ«å°¾ä¸º0x02,å³è¡¨ç¤ºå¡«å……äº†2ä¸ªPaddingï¼Œå¦‚æœæœ€åçš„Paddingä¸æ­£ç¡®ï¼Œå³å€¼å’Œæ•°é‡ä¸ä¸€è‡´ï¼Œé‚£ä¹ˆè§£å¯†ç¨‹åºå¾€å¾€ä¼šæŠ›å‡ºå¼‚å¸¸(Padding Error)ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åº”ç”¨çš„é”™è¯¯å›æ˜¾ï¼Œåˆ¤æ–­å‡ºPaddingæ˜¯å¦æ­£ç¡®ã€‚
> - å‰ææ¡ä»¶æ˜¯æœåŠ¡å™¨ä¼šå¯¹æˆ‘ä»¬æ˜¾ç¤ºpadding errorçš„å¼‚å¸¸ï¼Œå¦‚æœä¸å›æ˜¾é‚£ä¹ˆå°±æ— æ³•åˆ¤æ–­å¹¶è¿›è¡Œåˆ©ç”¨ã€‚
> - ä¾‹å¦‚åœ¨webåº”ç”¨ä¸­ï¼Œå¦‚æœPaddingä¸æ­£ç¡®ï¼Œåˆ™åº”ç”¨ç¨‹åºå¾ˆå¯èƒ½ä¼šè¿”å›500çš„é”™è¯¯ï¼ˆç¨‹åºæ‰§è¡Œé”™è¯¯ï¼‰ï¼›å¦‚æœPaddingæ­£ç¡®ï¼Œä½†è§£å¯†å‡ºæ¥çš„å†…å®¹ä¸æ­£ç¡®ï¼Œåˆ™å¯èƒ½ä¼šè¿”å›200çš„è‡ªå®šä¹‰é”™è¯¯ï¼ˆä¸šåŠ¡ä¸Šçš„è§„å®šï¼‰ã€‚æ‰€ä»¥ï¼Œè¿™ç§åŒºåˆ«å°±å¯ä»¥æˆä¸ºä¸€ä¸ªäºŒå€¼é€»è¾‘çš„â€œæ³¨å…¥ç‚¹â€ã€‚

æ”»å‡»æˆç«‹çš„ä¸¤ä¸ªé‡è¦çš„å‡è®¾å‰æï¼š

```
1. æ”»å‡»è€…èƒ½å¤Ÿè·å¾—å¯†æ–‡ï¼ˆCiphertextï¼‰ï¼Œä»¥åŠé™„å¸¦åœ¨å¯†æ–‡å‰é¢çš„IVï¼ˆåˆå§‹åŒ–å‘é‡ï¼‰
2. æ”»å‡»è€…èƒ½å¤Ÿè§¦å‘å¯†æ–‡çš„è§£å¯†è¿‡ç¨‹ï¼Œä¸”èƒ½å¤ŸçŸ¥é“å¯†æ–‡çš„è§£å¯†ç»“æœ
```

> - æ”»å‡»æµç¨‹å®é™…ä¸Šæ˜¯ä¸æ–­åœ°è°ƒæ•´IVçš„å€¼ï¼Œåœ¨è§£å¯†ä¹‹åï¼Œæœ€åä¸€ä¸ªå­—èŠ‚çš„å€¼ä¸ºæ­£ç¡®çš„Padding Byteï¼Œå› ä¸ºpaddingæ­£ç¡®æ—¶ï¼Œè¿™æ—¶paddingæ­£ç¡®æ˜¯æŒ‡æœ€ç»ˆè§£å¯†å¹¶å¼‚æˆ–å‡ºæ¥çš„æ˜æ–‡æœ€åä¸€ä¸ªå­—èŠ‚åœ¨æ­£ç¡®paddingçš„èŒƒå›´å†…å°±æ˜¯æ­£ç¡®çš„ï¼Œè™½ç„¶æœ€åå¾—åˆ°çš„æ˜æ–‡ä¸ä¸€å®šæ­£ç¡®ï¼Œä½†æ˜¯paddingæ˜¯åˆæ³•çš„ï¼Œæ‰€ä»¥æœåŠ¡å™¨è¿”å›200 ã€‚
> - åˆ¤æ–­æƒ…å†µ
> ```
> ï¼ˆ1ï¼‰æ­£å¸¸è§£å¯†ï¼Œå¾—åˆ°æ˜æ–‡
> ï¼ˆ2ï¼‰è§£å¯†æˆåŠŸï¼Œä½†æ˜¯è§£å¯†å¾—åˆ°çš„å’Œæ˜æ–‡ä¸åŒ¹é…
> ï¼ˆ3ï¼‰è§£å¯†é”™è¯¯ï¼ŒæŠ›å‡ºå¼‚å¸¸
> ```
>
> - ä¾‹å¦‚åŠ å¯†æ•°æ®åº”ç”¨äºcookie

## CBCå­—èŠ‚ç¿»è½¬æ”»å‡»

### æ”»å‡»åŸç†

> - åœ¨ CBC è§£å¯†çš„å…¬å¼æè¿°ä¸­å¯ä»¥æ³¨æ„åˆ°Ciphertext-(N-1)æ˜¯ç”¨æ¥äº§ç”Ÿä¸‹ä¸€å—æ˜æ–‡ï¼Œè¿™é‡Œæ˜¯å­—èŠ‚ç¿»è½¬æ”»å‡»å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚å¦‚æœæˆ‘ä»¬æ”¹å˜Ciphertext-N-1ä¸­çš„ä¸€ä¸ªå­—èŠ‚ï¼Œç„¶åå’Œä¸‹ä¸€å—è§£å¯†åçš„å¯†æ–‡xorï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªä¸åŒçš„æ˜æ–‡ï¼Œè€Œè¿™ä¸ªæ˜æ–‡æ˜¯æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„ã€‚
> - åœ¨æ­¤åŸºç¡€ä¸Šï¼Œé€šè¿‡ç ´åå¯†æ–‡ä¸­çš„å­—èŠ‚æ¥æ”¹å˜æ˜æ–‡ä¸­çš„å­—èŠ‚ï¼Œå› æ­¤åœ¨ç ´åçš„å¯†æ–‡ä¸­æ·»åŠ å•å¼•å·ç­‰æ¶æ„å­—ç¬¦æ¥ç»•è¿‡è¿‡æ»¤å™¨ï¼Œæˆ–é€šè¿‡å°†ç”¨æˆ·IDæ›´æ”¹ä¸ºadminæ¥æå‡æƒé™ï¼Œæˆ–è€…æ›´æ”¹åº”ç”¨ç¨‹åºæ‰€éœ€çš„æ˜æ–‡é€ æˆå…¶ä»–åæœã€‚

### æ”»å‡»æµç¨‹

![CBCDturn](/images/CBC/CBCDturn.jpg)

> - é€šè¿‡ä¿®æ”¹ç¬¬ä¸€ç»„çš„å¯†æ–‡å—å­—èŠ‚ï¼Œæ¥æ„é€ æˆ‘ä»¬éœ€è¦çš„ç¬¬äºŒç»„æ˜æ–‡ï¼Œ å½“ç¬¬ä¸€ç»„å¯†æ–‡å—å­—èŠ‚å‘ç”Ÿæ”¹å˜æ—¶ä¼šå½±å“ç¬¬ä¸€ç»„æ˜æ–‡å—å’Œç¬¬äºŒç»„æ˜æ–‡å—ã€‚ 
>
> - å‡å¦‚æˆ‘ä»¬å·²çŸ¥çš„æ˜æ–‡è§£å¯†åä¸º1dminï¼Œæˆ‘ä»¬æƒ³æ„é€ ä¸€ä¸ªåˆå§‹IVï¼Œä½¿å…¶è§£å¯†æˆadminï¼Œå› æ­¤æœ‰ä»¥ä¸‹é€»è¾‘ï¼š
>
> ```
> åŸå§‹çš„IV[1]^middle[i]=plain[1]  <<<  é¢˜ç›®é€»è¾‘
> ä¿®æ”¹çš„IV[1]^middle[i]='a'       <<<  æˆ‘ä»¬æƒ³è¦
> æ„é€ çš„IV[1]=middle[1]^'a'       <<<  æˆ‘ä»¬å¯ä»¥å¾—åˆ°
> ```
>
> - ç”¨å…¬å¼è¡¨ç¤º
>
> ```
> A = B ^ C
> C = A ^ B
> A ^ B ^ C = 0
> A ^ B ^ C ^ C' = C'
> ```
>
> - è€ŒåŸæ¥çš„ä¸­é—´æ˜æ–‡å¯ä»¥å¦‚ä¸‹æ–¹å¼é€šè¿‡ï¼ŒåŸæ¥çš„æ˜æ–‡ç¬¬ä¸€ä½åˆæ˜¯å¯ä»¥é€šè¿‡Padding Oracleæ”»å‡»å¾—åˆ°çš„
>
> ```
> middle[1]=åŸæ¥çš„IV[1]^plain[1]	      <<<  Padding Oracle æ”»å‡»
> æ„é€ çš„IV[1]=åŸæ¥çš„IV[1]^plain[1]^'a' 	<<<  IVçš„ç¬¬ä¸€ä½
> ```

## é¢˜ç›®å‚è€ƒ

[[NCTF2017] Be Admin](https://buuoj.cn/challenges#[NCTF2017]Be%20admin)

[[NPUCTF2020]webğŸ•](https://buuoj.cn/challenges#[NPUCTF2020]web%F0%9F%90%95)

