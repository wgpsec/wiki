(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{790:function(e,s,a){"use strict";a.r(s);var r=a(103),t=Object(r.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"应用简介"}},[e._v("应用简介 "),a("a",{staticClass:"header-anchor",attrs:{href:"#应用简介"}},[e._v("#")])]),e._v(" "),a("p",[e._v("Shiro 是 Apache 旗下的一个用于权限管理的开源框架，提供开箱即用的身份验证、授权、密码套件和会话管理等功能")]),e._v(" "),a("h2",{attrs:{id:"cve-2016-4437-shiro-550反序列化"}},[e._v("[CVE-2016-4437]-Shiro 550反序列化 "),a("a",{staticClass:"header-anchor",attrs:{href:"#cve-2016-4437-shiro-550反序列化"}},[e._v("#")])]),e._v(" "),a("p",[a("strong",[e._v("漏洞概述")])]),e._v(" "),a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[e._v("#影响版本\nShiro <= 1.2.4\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("在 Shiro 1.2.4 及之前的版本，Shiro 秘钥是硬编码的一个值 "),a("code",[e._v("kPH+bIxk5D2deZiIxcaaaA==")]),e._v("，这便是 Shiro-550 的漏洞成因。但这个漏洞不只存在于 1.2.4 版本，后续版本的读取流程没有什么改动，这就意味着只要秘钥泄露，依然存在高危风险。")]),e._v(" "),a("p",[e._v("Shiro Top 100 Key 是基于一些 Github 示例代码收集的")]),e._v(" "),a("p",[a("strong",[e._v("漏洞利用")])]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("use multi/http/shiro_rememberme_v124_deserialize\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("h2",{attrs:{id:"shiro-721-padding-oracle漏洞"}},[e._v("Shiro 721 Padding Oracle漏洞 "),a("a",{staticClass:"header-anchor",attrs:{href:"#shiro-721-padding-oracle漏洞"}},[e._v("#")])]),e._v(" "),a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[e._v("#影响版本\nShiro < 1.4.2\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("p",[e._v("Shrio所使用的cookie里的rememberMe字段采用了AES-128-CBC的加密模式，这使得该字段可以被padding oracle 攻击利用。")]),e._v(" "),a("p",[e._v("攻击者可以使用一个合法有效的rememberMe 的cookie作为前缀来实施POA，然后制造一个特制的rememberMe来执行Java反序列化攻击，比如Shrio 550那样的")]),e._v(" "),a("p",[a("strong",[e._v("实施步骤：")])]),e._v(" "),a("ol",[a("li",[e._v("登录网站，任意用户，来获取一个合法的remmemberMe cookie。")]),e._v(" "),a("li",[e._v("使用rememberMe cookie作为前缀来实施POA。")]),e._v(" "),a("li",[e._v("加密Java反序列化的payload来制作特制的rememberMe")]),e._v(" "),a("li",[e._v("带着新的rememberMe向网站发起请求")])]),e._v(" "),a("p",[e._v("这个漏洞相较于550而言，它不需要知道key的值，但是它需要一个合法用户的rememberMe cookie，这大概是它比较鸡肋的地方了")]),e._v(" "),a("p",[a("strong",[e._v("对于550和721飞鸿大佬写了一键化利用工具")])]),e._v(" "),a("p",[e._v("https://github.com/feihong-cs/ShiroExploit-Deprecated")]),e._v(" "),a("h2",{attrs:{id:"shiro-682-权限绕过漏洞"}},[e._v("Shiro-682 权限绕过漏洞 "),a("a",{staticClass:"header-anchor",attrs:{href:"#shiro-682-权限绕过漏洞"}},[e._v("#")])]),e._v(" "),a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[e._v("#影响版本\nShiro\t1.3.2\nShiro < 1.5.0\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("p",[a("strong",[e._v("利用")])]),e._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[e._v("use "),a("span",{pre:!0,attrs:{class:"token string"}},[e._v("\"uri = uri + '/' \"")]),e._v(" to bypassed shiro protect\n即URL结尾添加反斜杠绕过权限验证\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])]),a("h2",{attrs:{id:"cve-2020-13933-shiro-权限绕过漏洞"}},[e._v("[CVE-2020-13933]-Shiro 权限绕过漏洞 "),a("a",{staticClass:"header-anchor",attrs:{href:"#cve-2020-13933-shiro-权限绕过漏洞"}},[e._v("#")])]),e._v(" "),a("p",[a("strong",[e._v("Shiro < 1.6.0")])]),e._v(" "),a("p",[e._v("POC")]),e._v(" "),a("div",{staticClass:"language-http line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[e._v("xxx.com/res/;name\n\n当请求的资源存在时即可绕过权限验证查看资源\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("h2",{attrs:{id:"shiro漏洞分析"}},[e._v("Shiro漏洞分析 "),a("a",{staticClass:"header-anchor",attrs:{href:"#shiro漏洞分析"}},[e._v("#")])]),e._v(" "),a("p",[a("strong",[e._v("Shiro RememberMe 漏洞检测的探索之路")])]),e._v(" "),a("p",[e._v("https://paper.seebug.org/1285/")])])}),[],!1,null,null,null);s.default=t.exports}}]);