(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{749:function(t,s,a){"use strict";a.r(s);var e=a(103),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"提高攻击成本-减少攻击意愿"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#提高攻击成本-减少攻击意愿"}},[t._v("#")]),t._v(" 提高攻击成本，减少攻击意愿")]),t._v(" "),a("h2",{attrs:{id:"部署蜜罐"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署蜜罐"}},[t._v("#")]),t._v(" 部署蜜罐")]),t._v(" "),a("p",[t._v("如果客户购买了带有攻击者画像功能的现在蜜罐设备，那就爽歪歪了，等着上钩就行；")]),t._v(" "),a("p",[t._v("如果没有的话，可以自己学习一下蜜罐的知识，下边是推荐资源")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/paralax/awesome-honeypots/blob/master/README_CN.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("最优秀的蜜罐列表"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://ipot.sec-wiki.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("蜜罐技术研究小组"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("请欣赏奇安信"),a("code",[t._v("归零Null")]),t._v("师傅的"),a("a",{attrs:{href:"https://mp.weixin.qq.com/s/m4I_YDn98K_A2yGAhv67Gg",target:"_blank",rel:"noopener noreferrer"}},[t._v("MySQL蜜罐获取攻击者微信ID"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"废掉攻击者的手段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#废掉攻击者的手段"}},[t._v("#")]),t._v(" 废掉攻击者的手段")]),t._v(" "),a("p",[a("strong",[t._v("本地密码抓取的防御方法")])]),t._v(" "),a("blockquote",[a("p",[t._v('1、2012 R2之后的版本，把用户放入 ->  "受保护的用户" 的用户组，就不能抓取明文密码和散列值了。')]),t._v(" "),a("p",[t._v("2、安装"),a("code",[t._v("KB2871997")]),t._v("，并禁用"),a("code",[t._v("Administrator")]),t._v("账号（SID为500的账户，防止哈希传递攻击）")])]),t._v(" "),a("p",[t._v("Windows Server 2012 之后的版本默认关闭"),a("code",[t._v("Wdigest")]),t._v("，无法从内存中获取明文密码。")]),t._v(" "),a("p",[t._v("2012之前的版本安装了"),a("code",[t._v("KB2871997")]),t._v("，同样无法获取明文密码。")]),t._v(" "),a("p",[a("strong",[t._v("开启和关闭"),a("code",[t._v("Wdigest")]),t._v("的命令")])]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#开启，值为1")]),t._v("\nreg "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" HKLM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("SYSTEM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("CurrentControlSet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Control"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("SecurityProviders"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("WDigest /v UseLogonCredential /t REG_DWORD /d "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" /f\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#关闭，值为0")]),t._v("\nreg "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" HKLM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("SYSTEM"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("CurrentControlSet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("Control"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("SecurityProviders"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("WDigest /v UseLogonCredential /t REG_DWORD /d "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" /f\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("p",[a("strong",[t._v("Webshell管理工具（冰蝎、蚁剑、哥斯拉等）")])]),t._v(" "),a("p",[t._v("分析工具的流量特征，在WAF等防护设备上添加自定义规则")]),t._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uri_path * rco "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("jsp"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("jspx"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("php"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("method * belong POST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request_body * req ^"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("w+/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v(","),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("?"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("?$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[a("strong",[t._v("防御mimikatz攻击")])]),t._v(" "),a("p",[a("code",[t._v("mimikatz")]),t._v("在抓取明文密码或散列值时，需要Debug权限。")]),t._v(" "),a("p",[t._v("因为"),a("code",[t._v("mimikatz")]),t._v("需要和"),a("code",[t._v("lsass")]),t._v("进程进行交互，没有"),a("code",[t._v("Debug")]),t._v("权限的话"),a("code",[t._v("mimikatz")]),t._v("将不能读取"),a("code",[t._v("lsass")]),t._v("进程。")]),t._v(" "),a("p",[t._v("因此，将拥有Debug权限的本地管理员从"),a("code",[t._v("Administrators")]),t._v("组中删除即可。")]),t._v(" "),a("p",[a("strong",[t._v("其它内网渗透工具")])]),t._v(" "),a("blockquote",[a("p",[t._v("CobaltStrike、Metasploit等c2工具")]),t._v(" "),a("p",[t._v("frp、nps、reGeorg、ew、Termite、lcx等通道构建工具")]),t._v(" "),a("p",[t._v("impacket工具包")]),t._v(" "),a("p",[t._v("**具体做法：**分析工具流量特征，在WAF等防护设备上自定义相关规则")]),t._v(" "),a("p",[a("strong",[t._v("可参考：")]),t._v(" "),a("a",{attrs:{href:"https://xz.aliyun.com/t/7606",target:"_blank",rel:"noopener noreferrer"}},[t._v("加密Webshell“冰蝎” 流量 100%识别"),a("OutboundLink")],1)])]),t._v(" "),a("h1",{attrs:{id:"溯源攻击者"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#溯源攻击者"}},[t._v("#")]),t._v(" 溯源攻击者")]),t._v(" "),a("blockquote",[a("p",[t._v("1、通过威胁情报分析，溯源IP\t（微步、QAX威胁情报中心等）")]),t._v(" "),a("p",[t._v("2、反向渗透攻击者VPS")]),t._v(" "),a("p",[t._v("3、社工攻击者虚拟身份、真实身份（通过攻击者的常用shell特征、VPS地址信息、常用ID等入手）")]),t._v(" "),a("p",[t._v("如果能确认攻击者的邮箱或QQ等信息，社工库机器人走一波就差不多了")])]),t._v(" "),a("p",[t._v("详细过程建议参考以下文章：")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://paper.seebug.org/945/#357-philipbeekoohk",target:"_blank",rel:"noopener noreferrer"}},[t._v("如何通过一封恶意邮件追踪幕后黑客组织"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=n.exports}}]);